<div class="plist">
  @for (vm of rooms(); track vm.room.id) {
    <div class="plist-item">
      <div class="row g-3 align-items-center">
        <!-- Image -->
        <div class="col-12 col-lg-4">
          <div class="plist-media">
            <img class="plist-img" [src]="vm.mainPhoto" [alt]="vm.room.name">

            <div class="plist-badges">
              @if (vm.room.verifiedListing) {
                <span class="plist-badge badge-verified">
                  <i class="bi bi-patch-check-fill me-1"></i> Verified
                </span>
              }
              <span class="plist-badge" [ngClass]="vm.statusClass">
                {{ vm.statusText }}
              </span>
            </div>

            @if (vm.photoCount > 1) {
              <span class="plist-count">
                <i class="bi bi-images me-1"></i> {{ vm.photoCount }}
              </span>
            }
          </div>
        </div>

        <!-- Content -->
        <div class="col-12 col-lg-8">
          <div class="plist-content">
            <div class="d-flex justify-content-between align-items-start gap-2">
              <div class="minw-0">
                <h4 class="plist-title mb-1" [title]="vm.room.name">{{ vm.room.name }}</h4>

                <div class="plist-location" [title]="vm.addressText">
                  <i class="bi bi-geo-alt me-1"></i>
                  <span>{{ vm.addressText || 'Location not specified' }}</span>
                </div>

                <div class="plist-meta mt-2">
                  @if (vm.room.roomType) {
                    <span class="meta-pill"><i class="bi bi-door-open me-1"></i> {{ vm.room.roomType }}</span>
                  }
                  @if (vm.room.propertyType) {
                    <span class="meta-pill"><i class="bi bi-house me-1"></i> {{ vm.room.propertyType }}</span>
                  }
                  @if (vm.room.roomSize) {
                    <span class="meta-pill"><i class="bi bi-arrows-angle-expand me-1"></i> {{ vm.room.roomSize }} mÂ²</span>
                  }
                  @if (vm.room.maxOccupants) {
                    <span class="meta-pill"><i class="bi bi-people me-1"></i> Max {{ vm.room.maxOccupants }}</span>
                  }
                </div>
              </div>

              <div class="text-end">
                <div class="plist-price">{{ vm.priceText }}</div>

                @if (vm.room.depositRequired) {
                  <div class="small plist-deposit">
                    <i class="bi bi-shield-lock me-1"></i> Deposit
                  </div>
                }
              </div>
            </div>

            @if (vm.amenities.length > 0) {
              <div class="plist-amenities mt-2">
                @for (a of vm.amenities; track a.icon) {
                  <span class="amenity" [title]="a.label">
                    <i class="bi" [ngClass]="a.icon"></i>
                  </span>
                }
              </div>
            }

            <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mt-3">
              <div class="small text-muted">
                @if (vm.availableText) {
                  <span><i class="bi bi-calendar-event me-1"></i> Available from {{ vm.availableText }}</span>
                }
              </div>

              <div class="plist-actions d-flex gap-2">
                <button type="button"
                        class="btn btn-outline-secondary btn-sm"
                        title="Save"
                        (click)="favoriteToggle.emit(vm.room.id)">
                  <i class="bi" [ngClass]="vm.isFavorite ? 'bi-heart-fill' : 'bi-heart'"></i>
                </button>

                <a [routerLink]="['/properties', vm.room.id]" class="btn btn-primary btn-sm">
                  View details
                </a>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  }
</div>